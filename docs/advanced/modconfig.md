# ModConfig 配置选项

DuckovCustomSounds 支持通过 ModConfig 进行游戏内实时配置。所有配置项都可以在游戏中通过 ModConfig UI 进行修改,无需重启游戏即可生效。

## 配置模块列表

### 物品音效 (Item)

| 配置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| 启用自定义物品音效 | 布尔 | 是 | 总开关,控制是否启用物品音效替换 |
| 音量倍率 | 浮点 | 1.0 | 音量调节范围 0.0~2.0 |
| 启用 食物/饮料 声音 | 布尔 | 是 | 控制食物和饮料使用音效 |
| 启用 药品 声音 | 布尔 | 是 | 控制药品使用音效 |
| 启用 注射器 声音 | 布尔 | 是 | 控制注射器使用音效 |

### 枪械音效 (Gun)

| 配置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| 启用自定义枪械音效 | 布尔 | 是 | 总开关,控制是否启用枪械音效替换 |
| 音量 | 浮点 | 1.0 | 音量调节范围 0.0~2.0 |

### 近战音效 (Melee)

| 配置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| 启用自定义近战音效 | 布尔 | 是 | 总开关,控制是否启用近战音效替换 |
| 音量 | 浮点 | 1.0 | 音量调节范围 0.0~2.0 |

### 手雷音效 (Grenade)

| 配置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| 启用自定义手雷音效 | 布尔 | 是 | 总开关,控制是否启用手雷音效替换 |
| 音量 | 浮点 | 1.0 | 音量调节范围 0.0~2.0 |

### 脚步声 (Footstep)

| 配置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| 启用自定义脚步音效 | 布尔 | 是 | 总开关,控制是否启用脚步声替换 |
| 音量 | 浮点 | 1.0 | 音量调节范围 0.0~2.0 |

### 敌人语音 (EnemyVoice)

| 配置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| 允许 NPC-对-NPC 战斗语音 | 布尔 | 是 | 控制 NPC 之间战斗时是否播放语音 |
| 语音模式 | 枚举 | Default | 语音播放模式选择 |

### 主页 BGM (HomeBGM)

| 配置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| 启用主页BGM | 布尔 | 是 | 总开关,控制是否启用主页背景音乐 |
| 启用进入基地音效 | 布尔 | 是 | 控制进入基地时的 start.mp3 音效 |
| 音乐音量 | 整数 | 100 | 音量百分比,范围 0~100% |
| 使用 SFX 总线播放 | 布尔 | 否 | 实验性功能,可能改善立体声效果 |
| 随机播放(Next) | 布尔 | 否 | 下一曲是否随机选择 |
| 上一曲也随机 | 布尔 | 否 | 上一曲是否也随机选择 |
| 启用淡入淡出 | 布尔 | 是 | 音乐切换时的淡入淡出效果 |
| 淡入淡出时长 | 浮点 | 1.0 | 淡入淡出持续时间(秒) |

### 场景 BGM (SceneBGM)

| 配置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| 启用场景音乐系统 | 布尔 | 是 | 总开关,控制场景背景音乐系统 |
| [进入BGM] 启用进入场景 BGM | 布尔 | 是 | 控制进入场景时的音乐 |
| [进入BGM] 进入音乐音量 | 浮点 | 100 | 进入场景音乐音量百分比 0~100% |
| [循环BGM] 启用循环场景 BGM | 布尔 | 是 | 控制场景循环背景音乐 |
| [循环BGM] 循环音乐音量 | 浮点 | 100 | 循环音乐音量百分比 0~100% |
| 淡入淡出时长 | 浮点 | 1.0 | 音乐切换时的淡入淡出时长(秒) |

### BOSS BGM (BossBGM)

| 配置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| 启用 BOSS BGM | 布尔 | 是 | 总开关,控制 BOSS 战斗音乐 |
| 触发距离 | 浮点 | 50.0 | BOSS 音乐触发距离(米),范围 10~200 |

### 撤离 BGM (ExtractionBGM)

| 配置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| 模式 | 枚举 | Default | 撤离音乐播放模式 |

### 击杀反馈 (KillFeedback)

| 配置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| 启用 自定义击杀反馈 | 布尔 | 是 | 总开关,控制击杀反馈系统 |
| 连杀窗口 | 浮点 | 5.0 | 连杀判定时间窗口(秒),范围 2~10 |
| UI显示时长 | 浮点 | 1.5 | 击杀提示显示时长(秒),范围 0.5~3 |
| 2D 音频 | 布尔 | 是 | 是否使用 2D 音频(关闭为 3D) |
| 音量倍率 | 浮点 | 1.0 | 音量调节范围 0.1~2.0 |
| 显示 击杀图标 | 布尔 | 是 | 是否显示击杀图标 |

### 音效包 (DuckovCustomSounds)

| 配置项 | 类型 | 默认值 | 说明 |
|--------|------|--------|------|
| 音效包 | 下拉列表 | default | 选择要使用的音效包 |

## 使用说明

### 如何打开 ModConfig

1. 启动游戏
2. 在主菜单或游戏中按 ESC 打开菜单
3. 找到并点击 "ModConfig" 选项
4. 在左侧列表中选择对应的模块进行配置

### 配置生效时机

- **实时生效**: 大部分配置项修改后立即生效,无需重启游戏
- **下次触发生效**: 部分配置(如音效包选择)需要在下次触发相关事件时生效
- **重启生效**: 极少数配置可能需要重启游戏才能完全生效

### 配置持久化

所有通过 ModConfig 修改的配置都会自动保存到 `ModConfig.ES3` 文件中,下次启动游戏时会自动加载。

## 常见问题

### Q: 修改配置后没有效果?

A: 请检查:
1. 对应模块的总开关是否已启用
2. 是否已放置对应的自定义音频文件
3. 查看日志文件确认是否有错误信息

### Q: 音量设置为 0 后还能听到声音?

A: 音量设置为 0 会完全静音。如果仍能听到声音,可能是:
1. 其他模块的音效(检查是否禁用了正确的模块)
2. 原版游戏音效(需要在游戏设置中调整)

### Q: 如何恢复默认配置?

A: 有两种方法:
1. 在 ModConfig UI 中手动将各项设置改回默认值
2. 删除游戏目录下的 `ModConfig.ES3` 文件,重启游戏后会使用默认配置

## 技术说明

### 配置系统架构

DuckovCustomSounds 使用统一的 ModConfig 集成系统:

- **ModConfigAPI**: 安全的反射 API 包装器,支持 ModConfig 未安装时的优雅降级
- **ES3 持久化**: 配置数据通过 ES3 系统保存,确保跨会话持久化
- **事件驱动**: 配置变更通过事件系统通知各模块,实现热重载

### 开发者信息

如果你是开发者,想要为自己的模块添加 ModConfig 支持,请参考:
- [ModConfig 集成教程](../../ModConfig/ModConfig集成教程.md)
- [ModConfig 维护指南](../../ModConfig/modConfig集成.md)

## 更新日志

### v2.x
- ✅ 修复音量配置未实际应用的问题 (Item, Gun, Melee, Grenade 模块)
- ✅ 统一模块命名规范 (EnemyVoiceMod → EnemyVoice)
- ✅ 完善所有模块的 ModConfig 集成
- ✅ 新增本配置文档

### v1.x
- 初始 ModConfig 支持
- 基础配置项实现

